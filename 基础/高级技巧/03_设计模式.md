# 设计模式

## 学习目标

1. 掌握单例模式的作用和写法
2. 掌握工厂模式的作用和写法

------

## 什么是设计模式？

设计模式是一种编程套路，可以极大的方便程序的开发。
最常见、最经典的设计模式，就是我们所学习的**面向对象**。

除了面向对象外，在编程中也有很多既定的套路可以方便开发，我们称之为设计模式，例如：

- 单例、工厂模式
- 建造者、责任链、状态、备忘录、解释器、访问者、观察者、中介、模板、代理模式
- 等等模式

------

## 单例模式

### 什么是单例模式？

单例模式（Singleton Pattern）是一种常用的软件设计模式，该模式的主要目的是确保某一个类只有一个实例存在。在整个系统中，某个类只能出现一个实例时，单例对象就能派上用场。

**定义**：保证一个类只有一个实例，并提供一个访问它的全局访问点。
**适用场景**：当一个类只能有一个实例，而客户可以从一个众所周知的访问点访问它时。

### 为什么要使用单例模式？

python

```
class Tool:
    pass

t1 = Tool()
t2 = Tool()
print(t1)
print(t2)
```



**输出：**

text

```
<__main__.Tool object at 0x0000027246FCCEE0>
<__main__.Tool object at 0x0000027246FC09F0>
```



创建类的实例后，就可以得到一个完整的、独立的类对象。通过print语句可以看出，它们的内存地址是不相同的，即`t1`和`t2`是完全独立的两个对象。

某些场景下，我们需要一个类无论获取多少次类对象，都仅仅提供一个具体的实例，用以节省创建类对象的开销和内存开销。
比如某些工具类，仅需要1个实例，即可在各处使用。

### 单例模式的实现示例

#### 在一个文件中定义：

python

```
class StrTools:
    pass

str_tool = StrTools()
```



#### 在另一个文件中导入对象：

python

```
from test import str_tool

s1 = str_tool
s2 = str_tool
print(s1)
print(s2)
```



**输出：**

text

```
<test.StrTools object at 0x0000013000100910>
<test.StrTools object at 0x0000013000100910>
```



`s1`和`s2`是同一个对象。

------

## 工厂模式

### 什么是工厂模式？

当需要大量创建一个类的实例的时候，可以使用工厂模式。
即，从原生的使用类的构造去创建对象的形式，迁移到基于工厂提供的方法去创建对象的形式。

### 工厂模式示例

#### 原生创建方式：

python

```
class Person:
    pass

class Worker(Person):
    pass

class Student(Person):
    pass

class Teacher(Person):
    pass

worker = Worker()
stu = Student()
teacher = Teacher()
```



#### 使用工厂模式：

python

```
class Person:
    pass

class Worker(Person):
    pass

class Student(Person):
    pass

class Teacher(Person):
    pass

class Factory:
    def get_person(self, p_type):
        if p_type == 'w':
            return Worker()
        elif p_type == 's':
            return Student()
        else:
            return Teacher()

factory = Factory()
worker = factory.get_person('w')
stu = factory.get_person('s')
teacher = factory.get_person('t')
```



### 工厂模式的优点

- 大批量创建对象的时候有统一的入口，易于代码维护
- 当发生修改，仅修改工厂类的创建方法即可
- 符合现实世界的模式，即由工厂来制作产品（对象）

------

## 总结

### 1. 什么是设计模式？

设计模式就是一种编程套路，使用特定的套路得到特定的效果。

### 2. 什么是单例设计模式？

单例模式就是对一个类，只获取其唯一的类实例对象，持续复用它。

**优点**：

- 节省内存
- 节省创建对象的开销

### 3. 什么是工厂模式？

将对象的创建由使用原生类本身创建，转换到由特定的工厂方法来创建。

**优点**：

- 大批量创建对象的时候有统一的入口，易于代码维护
- 当发生修改，仅修改工厂类的创建方法即可
- 符合现实世界的模式，即由工厂来制作产品（对象）